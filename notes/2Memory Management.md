# Memory Management

## 前言知识

由前面的启动那章我们已经大致了解到，BIOS最后会将启动代码Boot Loader加载到0x7C00处，接着 Boot Loader 代码执行的后面会将内核代码的ELF文件头读取到0x1000开始的4KB内存中，然后根据ELF文件头将内核代码加载到0x100000开始的地方，之后先执行entry.S文件中的内容，在entry.S文件的最后调用`i386_init()`函数执行内核初始化操作，其中就包括初始化内存分配函数`mem_init()`函数，内存分配的实现主要在`kern/pmap.c`文件中。再讲解内存分配的实现之前先铺垫一下下面这些知识。

### 页表管理





## 存储器的层次结构

存储器的层次结构大致分为：CPU寄存器、高速缓存、主存储器、磁盘缓存

- 高速缓存

介于CPU寄存器和主存储器之前的存储器，主要用于备份主存中较常见的数据，以减少对主存储器的访问次数。

## 分页存储管理方式

分页存储管理将进程的逻辑地址空间分成若干个页，并为各页加以编号；同时把内存的物理地址空间分成若干个块，同时也为它们加以编号。在为进程分配内存时，以块为单位，将进程的若干个页分别装入到多个可以不相邻接的物理块中。

页表：在分页系统中，允许将进程的各个页分散地存储在内存的任一物理块中，为保证进程仍然能够正确地运行，即能在内存中找到每个页面所对应的物理块，系统又为每个进程建立了一张页面影响表，简称页表。进程地址空间内的所有页（0~n），依次在页表中有一页表项，其中记录了相应页在内存中对应的物理块号。**页表的作用是实现从页号到物理块号的地址映射。**

【此处需要一张图】